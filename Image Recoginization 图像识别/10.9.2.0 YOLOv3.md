# YOLOv3

## Intro

### Grid Cell
For our discussion, we crop our original photo. YOLO divides the input image into an S×S grid. Each grid cell predicts only one object. For example, the yellow grid cell below tries to predict the “person” object whose center (the blue dot) falls inside the grid cell.

![Each grid cell detects one object for our discussion](https://github.com/AarioAi/Note/blob/master/Image%20Recoginization%20%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/_asset/YOLOv3-grid-cell.jpg?raw=true)

Each grid cell predicts a fixed number of boundary boxes. In this example, the yellow grid cell makes two boundary box predictions (blue boxes) to locate where the person is.

![A grid makes two boundary-boxes for our discussion](https://github.com/AarioAi/Note/blob/master/Image%20Recoginization%20%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/_asset/YOLOv3-grid-bounding-box.jpg?raw=true)


For each grid cell,

* it predicts B boundary boxes and each box has one **box confidence score**,
*it detects one object only regardless of the number of boxes B,
* it predicts C **conditional class probabilities** (one per class for the likeliness of the object class).
  
To evaluate PASCAL VOC, YOLO uses 7×7 grids (S×S), 2 boundary boxes (B) and 20 classes (C).


![YOYO make SxS predictions with B boundary boxes.](https://github.com/AarioAi/Note/blob/master/Image%20Recoginization%20%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/_asset/YOLOv3-make-SxS-predictions.jpg?raw=true)



### Bounding Box Prediction

![Bounding Box Prediction](https://github.com/AarioAi/Note/blob/master/Image%20Recoginization%20%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB/_asset/YOLOv3-bounding-box.jpg?raw=true)

**Each boundary box contains 5 elements: (x, y, w, h) and a box confidence score**. The confidence score reflects how likely the box contains an object (**objectness**) and how accurate is the boundary box.

The network predicts 4 coordinates for each bounding box, $t_x$, $t_y$, $t_w$, $t_h$. If the cell is offset from the top left corner of the image by ($c_x$, $c_y$) and the bounding box prior has width and height $p_w$, $p_h$.


YOLOv3 predicts an objectness score for each bounding box using **logistic regression**. This should be 1 if the bounding box prior overlaps a ground truth object by more than any other bounding box prior. If the bounding box prior is not the best but does overlap a ground truth object by more than some threshold we ignore the prediction, following. We use the threshold of .5.

### Class Prediction
We do not use a softmax as we have found it is unnecessary for good performance, instead we simply use independent logistic classifiers.

During training we use **binary cross-entropy loss** for the class predictions.

> Using a softmax imposes the assumption that each box has exactly one class which is often not the case.


## Reference
* https://pjreddie.com/media/files/papers/YOLOv3.pdf
* https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088